<?xml version="1.0" encoding="utf-8"?>
<odoo>
<link rel="stylesheet" href="estate/static/src/css/style.css"/>
    <record id="menu_properties" model="website.menu">
        <field name="name">Properties</field>
        <field name="url">/estate</field>
        <field name="parent_id" ref="website.main_menu"/>
        <field name="sequence" type="int">50</field>
    </record>
    <template id="index">
        <title>Estate</title>
        <t t-call="website.layout">
            <div class="oe_structure">
                <div class="container">
                    <t t-foreach="properties" t-as="property">
                        <a t-attf-href="/estate/{{ slug(property) }}" class="text-decoration-none">
                            <div class="card" style="width:500px;height:500px;display:inline-block;margin:10px;">
                                <img class="card-img-top" t-attf-src="data:image/*;base64,{{property.property_image}}" style="width:100%;height:70%"/>
                                <div class="card-body">
                                    <h5 class="card-title" style="text-align:center">
                                        <t t-esc="property.name"/>
                                    </h5>
                                    <p class="card-text">Expected Price:
                                        <t t-esc="property.expected_price"/>
                                    </p>
                                    <p class="card-text">
                                        <t t-set="tag" t-value="property.mapped('property_tag_id')"/>
                                        <t t-foreach="tag" t-as="t">
                                            <span t-field="t.name"  class="badge rounded-pill bg-danger text-dark"/>
                                        </t>
                                    </p>
                                </div>
                            </div>
                        </a>
                    </t>
                </div>
            </div>
            <div t-if="pager" class="o_portal_paper d-flex justify-context-center">
                <t t-call="website.pager"/>
            </div>
        </t>
    </template>
    <template id="listing">
        <t t-call="website.layout">
            <div class="container" style="margin-top:50px">
                <h1 id="fo">
                    <span t-field="plot.name"/>
                </h1>
                <t t-set="tag" t-value="plot.mapped('property_tag_id')"/>
                <t t-foreach="tag" t-as="t">
                    <span t-field="t.name"  class="badge rounded-pill bg-info text-dark"/>
                </t>
                <div>
                    <img class="float-end" t-attf-src="data:image/*;base64,{{plot.property_image}}" style="width:30%;height:30%"/>
                </div>
                <div class="mt-3">
                    <p>
                        <strong>Property Type: </strong>
                        <span t-field="plot.property_type_id.name"/>
                    </p>
                    <p>
                        <strong>Postcode: </strong>
                        <span t-field="plot.postcode"/>
                    </p>
                    <p>
                        <strong>Available From: </strong>
                        <span t-field="plot.date_availability"/>
                    </p>
                    <p>
                        <strong>Expected Price: </strong>
                        <span t-field="plot.expected_price"/>
                    </p>
                    <p >
                        <strong>Best Offer: </strong>
                        <span t-field="plot.best_offer"/>
                    </p>
                </div>
                <div class="mt-5">
                    <h4 class="text-decoration-underline text-info">Property Info:</h4>
                    <p>
                        <strong>Bedrooms: </strong>
                        <span t-field="plot.bedrooms"/>
                    </p>
                    <p>
                        <strong>Facades: </strong>
                        <span t-field="plot.facades"/>
                    </p>
                    <p>
                            <strong>Living Area: </strong>
                            <span t-field="plot.living_area"/>
                        </p>
                    <t t-if="plot.garden">
                        <p>
                            <strong>Garden Area: </strong>
                            <span t-field="plot.garden_area"/>
                        </p>
                        <p>
                            <strong>Garden Orientation: </strong>
                            <span t-field="plot.garden_orientation"/>
                        </p>
                    </t>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Price</th>
                            <th>Partner</th>
                            <th>Validity(days)</th>
                            <th>Deadline</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="offers" t-value="plot.mapped('offers_id')"/>
                        <tr t-foreach="offers" t-as="offer">
                            <td>
                                <span t-field="offer.price"/>
                            </td>
                            <td>
                                <span t-field="offer.partner_id"/>
                            </td>
                            <td>
                                <span t-field="offer.validity"></span>
                            </td>
                            <td>
                                <span t-field="offer.date_deadline"></span>
                            </td>
                            <td>
                                <span t-field="offer.status"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </t>
    </template>
</odoo>