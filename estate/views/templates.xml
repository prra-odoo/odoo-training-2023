<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- add menu in the website  -->
    <record id="menu_properties" model="website.menu">
        <field name="name">Properties</field>
        <field name="url">/estate</field>
        <field name="parent_id" ref="website.main_menu"/>
        <field name="sequence" type="int">10</field>
    </record>
    <template id="index">
        <t t-call="website.layout">
            <t t-set="title">Real Estate Properties</t>
            <div class="oe_structure">
                <div class = "d-grid gap-2 d-md-flex justify-content-md-start">
                <form type="get" action="/estate/">
                    <div class="d-flex justify-content-between">
                        <input id="date_picker" type="date" name="date_picker" class="o_website_form_input o_website_form_date btn-outline-secondary"/>   
                        <button name="Listed After" type="submit" class="btn btn-outline-info" default_order="prop desc">Listed After</button>
                    </div>
                </form>
                </div>
                <div class="card-group">                   
                    <t t-foreach="properties" t-as="prop">
                        <div class="col-md-2 mt-2 mb-3 mx-5">
                            <a t-attf-href="/estate/{{ slug(prop) }}" class="text-decoration-none">
                                <div class="card" >
                                    <img alt="Avatar" t-attf-src="data:image/png;base64,#{prop.image}" width="360px" height="250px" />
                                    <div class="card-body">
                                        <center>
                                            <h4 class="card-title" style="font-size: 22px; font-weight: bold; color: #333;">
                                                <t t-esc="prop.name"/>
                                            </h4>
                                            <t t-foreach="prop.tag_ids" t-as="t">
                                                <span t-field="t.name" class="badge" style="color: black; background: #e8b610"/>
                                            </t>
                                            <p  style="font-size: 16px; color: #666;">
                                                        Expected Price:
                                                <t t-esc="prop.expected_price"/>
                                                <br/>
                                                        State:
                                                <t t-esc="prop.state"/>
                                            </p>
                                            <p>Best Offer:
                                                <t t-esc="prop.best_price"/>
                                            </p>
                                            <p>Available From:
                                                <t t-esc="prop.date_availability"/>
                                            </p>
                                            <div class="card-footer bg-white">
                                                <small class="text-muted bg-white rounded">
                                                    <p>Last modified:
                                                        <i t-field="prop.write_date" t-options='{"widget": "relative"}'/>
                                                    </p>
                                                </small>
                                            </div>
                                        </center>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </t>
                </div>
                <div t-if="pager" class="o_portal_pager d-flex mb-3 justify-content-center">
                    <t t-call="website.pager"/>
                </div>
            </div>
        </t>
    </template>
    <template id="property_details_view">
        <t t-call="website.layout">
            <t t-set="title">Property Details</t>
            <div class="container mt-3">
                <h1 class="text-primary">
                    <t t-esc="property.name"/>
                </h1>
                <t t-set="tag" t-value="property.mapped('tag_ids')"/>
                <div>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item">
                                <a href="/">Home</a>
                            </li>
                            <li class="breadcrumb-item">
                                <a href="/estate">properties</a>
                            </li>
                            <li class="breadcrumb-item active" aria-current="page">
                                <t t-esc="property.name"/>
                            </li>
                        </ol>
                    </nav>
                </div>
                <t t-foreach="tag" t-as="t">
                    <span t-field="t.name" class="badge rounded-pill bg-info text-dark"/>
                </t>
                <div>
                    <img class="float-end" t-attf-src="data:image/*;base64,{{property.image}}" style="width:30%;height:25%"/>
                </div>
                <div class="mt-3">
                    <p>
                        <strong>Property Type: </strong>
                        <t t-esc="property.property_type_id.name"/>
                    </p>
                    <p>
                        <strong>Postcode: </strong>
                        <t t-esc="property.postcode"/>
                    </p>
                    <p>
                        <strong>Available From: </strong>
                        <t t-esc="property.date_availability"/>
                    </p>
                    <p>
                        <strong>Expected Price: </strong>
                        <t t-esc="property.expected_price"/>
                    </p>
                    <p >
                        <strong>Best Offer: </strong>
                        <t t-esc="property.best_price"/>
                    </p>
                </div>
                <div class="mt-5">
                    <h4 class="text-decoration-underline text-info">Property Info:</h4>
                    <p>
                        <strong>Bedrooms: </strong>
                        <t t-esc="property.bedrooms"/>
                    </p>
                </div>
            </div>
        </t>
    </template>
</odoo>